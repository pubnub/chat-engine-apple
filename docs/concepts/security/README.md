## Encryption

### TLS/SSL Encryption

ChatEngine client libraries offer built-in TLS/SSL Encryption. With TLS/SSL enabled, your data is 
encrypted as it travels through the Internet. PubNub Transport Layer Encryption with `SSL` enabled 
by default.

### AES Encryption

To ensure the highest levels of message integrity TLS/SSL should be used in combination with PubNub 
Message Level Encryption using `AES` to guarantee end-to-end data security.

The example below demonstrates how to enable PubNub Data Layer Encryption with `AES`. When the 
client is initialized with a `cipherKey`, ChatEngine will encrypt the message payload with AES-256 
encryption before it is published to the network. Data will automatically be decrypted by the client 
SDK before it is displayed.

```objc
CENConfiguration *configuration = [CENConfiguration configurationWithPublishKey:@"mySubscribeKey" 
                                                                   subscribeKey:@"myPublishKey"];
configuration.cipherKey = @"myCipherKey";

self.client = [CENChatEngine clientWithConfiguration:configuration];
```

For more details about setting up AES with `cipherKey` see PubNub Knowledge 
Base: [AES Usage Examples](https://support.pubnub.com/support/solutions/articles/14000043506-aes-usage-examples).

**Note:** PubNub Message Level Encryption with `AES` may affect remote notifications triggering, 
because data for notification is part of encrypted payload.  


## Authorization

### Default security policy

When you call [CENChatEngine.connect](../../api-reference/chatengine#connect) with a `UUID` 
parameter, the client SDK calls [PubNub Functions](https://www.pubnub.com/products/functions/) and 
[Access Manager](https://www.pubnub.com/docs/getting-started-guides/pubnub-access-manager) features 
to grant the user access to a set of chat channels by default. Once access is granted, the user's 
`UUID` and chat association is stored in PubNub and used for future login.

```objc
self.client.connect(@"UUID").perform();
```

The method also allows you to provide an `authKey` for added security. When an `authKey` is 
provided, the user is granted access to chat channels based on the `UUID` and `authKey`. Typically 
an `authKey` is generated by a third party authentication service and passed on to PubNub.

```objc
self.client.connect(@"UUID").authKey(@"authKey").perform();
```

Each user is granted access to the following channels upon login:  

| Channel            | Reference                                                | Sample Format                             | Default Permissions |
|:------------------:|:--------------------------------------------------------:| ----------------------------------------- | ------------------- |
| `Global Channel`   | [CENChatEngine.global](../../api-reference/chatengine#chat-global) | chat-engine                               | `read`/`write` access for all users. |
| `Direct Channel`   | [CENUser.direct](../../api-reference/user#direct)                  | chat-engine#user#uuid#write#direct        | The user who owns the channel has all permissions, while other users only have `write` permissions. |
| `Feed Channel`     | [CENUser.feed](../../api-reference/user#feed)                      | chat-engine#user#uuid#read#feed           | The user who owns the channel has all permissions, while other users only have `read` permissions. |
| `Public Channels`  | [CENChatEngine.chats](../../api-reference/chatengine#chats)        | chat-engine#chat#public.#custom-channel   | `read`/`write` access for all users. |
| `Private Channels` | [CENChatEngine.chats](../../api-reference/chatengine#chats)        | chat-engine#chat#private.#private-channel | `read`/`write` access for all users. |


## Securing Chats

The default `authPolicy()` method for ChatEngine is open and has no restrictions on the chats a user 
can join. A user's private, feed, and direct chats are accessible by anyone.

ChatEngine developers may update this `authPolicy()` method to introduce stricter access control 
across their ChatEngine user base.

It is possible to edit the default auth policy by adding logic to the ChatEngine PubNub Function. 
This logic can be added to the `authPolicy()` method within the PubNub Function code.

For example, you may send a request to a 3rd party server to validate a user's `UUID` and `authKey`. 
If the `authKey` is invalid or expired, the auth policy can prevent the client from ever connecting.

Follow the steps below to edit the ChatEngine auth policy:
* Navigate to the [PubNub Admin Portal](https://admin.pubnub.com).
* Find your ChatEngine app.
* Locate the ChatEngine PubNub Functions.
* Edit the `authPolicy()` code within the PubNub Function.
* Save the PubNub Function code and restart the PubNub Module.